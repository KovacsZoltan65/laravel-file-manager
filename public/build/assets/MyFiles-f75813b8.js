import{J as C,v as M,j as g,o as d,f,b as e,d as y,t as r,a as i,F as $,c as V,w,u as c,n as B,k as H,l as K,i as R,m as T,p as G,q as D,g as F,O as L,h as O,e as J}from"./app-ddfa9cd8.js";import{s as j,a as E,e as Q,O as W,A as X,H as Y}from"./AuthenticatedLayout-b94a33ce.js";import{h as Z,_ as ee,a as te}from"./http-helper-3f5fbdde.js";import{_ as I}from"./Checkbox-55a340b2.js";import{_ as le}from"./ConfirmationDialog-98f44991.js";import{_ as se}from"./DownloadFilesButton-3dc50cd8.js";import{_ as ae,a as oe}from"./SecondaryButton-af50fffc.js";import{_ as ne,a as re,b as ie}from"./TextInput-65742199.js";import{P as de}from"./PrimaryButton-683c0c78.js";import"./ApplicationLogo-05e4da24.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./DangerButton-92bf9790.js";const ce=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1),ue={__name:"DeleteFilesButton",props:{deleteAll:{type:Boolean,required:!1,default:!1},deleteIds:{type:Array,required:!1}},emits:["delete"],setup(x,{emit:_}){const s=x,a=C(),o=M({all:null,ids:[],parent_id:null}),u=g(!1);function h(){if(!s.deleteAll&&!s.deleteIds.length){j("Please select at least one file to delete");return}u.value=!0}function n(){u.value=!1}function p(){o.parent_id=a.props.folder.id,s.deleteAll?o.all=!0:o.ids=s.deleteIds,o.delete(route("file.delete"),{onSuccess:()=>{u.value=!1,_("delete"),E("Selected files have been deleted")}}),console.log("Delete",s.deleteAll,s.deleteIds)}return(v,k)=>(d(),f($,null,[e("button",{onClick:h,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[ce,y(" "+r(v.$t("delete")),1)]),i(le,{show:u.value,message:v.$t("delete_file_confirm"),onCancel:n,onConfirm:p},null,8,["show","message"])],64))}},me={class:"p-6"},fe=e("h2",{class:"text-lg font-medium text-gray-900"}," Share Files ",-1),he={class:"mt-6"},pe={class:"mt-6 flex justify-end"},xe={__name:"ShareFilesModal",props:{modelValue:Boolean,allSelected:Boolean,selectedIds:Array},emits:["update:modelValue"],setup(x,{emit:_}){const s=x,a=M({email:null,all:!1,ids:[],parent_id:null}),o=C(),u=g(null);function h(){K(()=>u.value.focus())}function n(){a.parent_id=o.props.folder.id,console.log(s.selectedIds,s.allSelected),s.allSelected?(a.all=!0,a.ids=[]):a.ids=s.selectedIds;const v=a.email;a.post(route("file.share"),{preserveScroll:!0,onSuccess:()=>{p(),a.reset(),E(`Selected files will be shared to "${v}" if the emails exists in the system`)},onError:()=>u.value.focus()})}function p(){_("update:modelValue"),a.clearErrors(),a.reset()}return(v,k)=>(d(),V(oe,{show:s.modelValue,onShow:h,"max-width":"sm"},{default:w(()=>[e("div",me,[fe,e("div",he,[i(ne,{for:"shareEmail",value:"Enter Email Address",class:"sr-only"}),i(re,{type:"text",ref_key:"emailInput",ref:u,id:"shareEmail",modelValue:c(a).email,"onUpdate:modelValue":k[0]||(k[0]=S=>c(a).email=S),class:B([c(a).errors.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"","mt-1 block w-full"]),placeholder:"Enter Email Address",onKeyup:H(n,["enter"])},null,8,["modelValue","class","onKeyup"]),i(ie,{message:c(a).errors.email,class:"mt-2"},null,8,["message"])]),e("div",pe,[i(ae,{onClick:p},{default:w(()=>[y("Cancel")]),_:1}),i(de,{class:B(["ml-3",{"opacity-25":c(a).processing}]),onClick:n,disable:c(a).processing},{default:w(()=>[y(" Submit ")]),_:1},8,["class","disable"])])])]),_:1},8,["show"]))}},_e=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"fill-rule":"evenodd",d:"M15.75 4.5a3 3 0 11.825 2.066l-8.421 4.679a3.002 3.002 0 010 1.51l8.421 4.679a3 3 0 11-.729 1.31l-8.421-4.678a3 3 0 110-4.132l8.421-4.679a3 3 0 01-.096-.755z","clip-rule":"evenodd"})],-1),ve={__name:"ShareFilesButton",props:{allSelected:{type:Boolean,required:!1,default:!1},selectedIds:{type:Array,required:!1}},emits:["restore"],setup(x,{emit:_}){const s=x;C(),M({all:null,ids:[],parent_id:null});const a=g(!1);function o(){if(!s.allSelected&&!s.selectedIds.length){j("Please select at least one file to share");return}a.value=!0}return(u,h)=>(d(),f($,null,[e("button",{onClick:o,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white mr-3"},[_e,y(" "+r(u.$t("share")),1)]),i(xe,{modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=n=>a.value=n),"all-selected":x.allSelected,"selected-ids":x.selectedIds},null,8,["modelValue","all-selected","selected-ids"])],64))}},ge={class:"flex items-center justify-between p-1 mb-3"},ye={class:"inline-flex items-center space-x-1 md:space-x-3"},we={key:1,class:"flex items-center"},ke=e("svg",{"aria-hidden":"true",class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),be={class:"flex"},$e={class:"flex items-center mr-3"},Ce={class:"flex-1 overflow-auto"},Se={class:"min-w-full"},Fe={class:"bg-gray-100 border-b"},Ie={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left w-[30px] max-w-[30px] pr-0"},Ve=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},null,-1),Be={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Me={key:0,class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Ee={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Ae={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},De={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Le=["onClick","onDblclick"],Oe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 w-[30px] max-w-[30px] pr-0"},je={class:"px-6 py-4 max-w-[40px] text-sm font-medium text-gray-900 text-yellow-500"},ze=["onClick"],Ue={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},Ne=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"},null,-1),Pe=[Ne],qe={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6"},He=e("path",{"fill-rule":"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z","clip-rule":"evenodd"},null,-1),Ke=[He],Re={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 flex items-center"},Te={key:0,class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},We={key:0,class:"py-8 text-center text-sm text-gray-400"},dt={__name:"MyFiles",props:{files:Object,folder:Object,ancestors:Object},setup(x){const _=x;C();const s=g(!1),a=g(!1),o=g({}),u=g(null);let h=g("");const n=g({data:_.files.data,next:_.files.links.next});let p=null;const v=R(()=>Object.entries(o.value).filter(t=>t[1]).map(t=>t[0]));function k(t){t.is_folder&&L.visit(route("myFiles",{folder:t.path}))}function S(){console.log("load more"),console.log(n.value.next),n.value.next!==null&&Z(n.value.next).then(t=>{n.value.data=[...n.value.data,...t.data],n.value.next=t.links.next})}function z(){n.value.data.forEach(t=>{o.value[t.id]=s.value})}function U(t){o.value[t.id]=!o.value[t.id],A(t)}function A(t){if(!o.value[t.id])s.value=!1;else{let m=!0;for(let l of n.value.data)if(!o.value[l.id]){m=!1;break}s.value=m}}function N(){s.value=!1,o.value={}}function P(t){te(route("file.addToFavourites"),{id:t.id}).then(()=>{t.is_favourite=!t.is_favourite,E("Selected files have been added to favourites")}).catch(async m=>{console.log(m.error.message)})}function q(){a.value?p.set("favourites",1):p.delete("favourites"),L.get(window.location.pathname+"?"+p.toString())}return T(()=>{n.value={data:_.files.data,next:_.files.links.next}}),G(()=>{p=new URLSearchParams(window.location.search),a.value=p.get("favourites")==="1",h.value=p.get("search"),Q.on(W,m=>{h.value=m}),new IntersectionObserver(m=>m.forEach(l=>l.isIntersecting&&S()),{rootMargin:"-250px 0px 0px 0px"}).observe(u.value)}),(t,m)=>(d(),V(X,null,{default:w(()=>[e("nav",ge,[e("ol",ye,[(d(!0),f($,null,D(x.ancestors.data,l=>(d(),f("li",{key:l.id,class:"inline-flex items-center"},[l.parent_id?(d(),f("div",we,[ke,i(c(O),{href:t.route("myFiles",{folder:l.path}),class:"ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white"},{default:w(()=>[y(r(l.name),1)]),_:2},1032,["href"])])):(d(),V(c(O),{key:0,href:t.route("myFiles"),class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"},{default:w(()=>[i(c(Y),{class:"w-4 h-4"}),y(" "+r(t.$t("my_files")),1)]),_:1},8,["href"]))]))),128))]),e("div",be,[e("label",$e,[y(r(t.$t("only_favourites"))+" ",1),i(I,{onChange:q,checked:a.value,"onUpdate:checked":m[0]||(m[0]=l=>a.value=l),class:"ml-2"},null,8,["checked"])]),i(ve,{"all-selected":s.value,"selected-ids":c(v)},null,8,["all-selected","selected-ids"]),i(se,{all:s.value,ids:c(v),class:"mr-2"},null,8,["all","ids"]),i(ue,{"delete-all":s.value,"delete-ids":c(v),onDelete:N},null,8,["delete-all","delete-ids"])])]),e("div",Ce,[e("table",Se,[e("thead",Fe,[e("tr",null,[e("th",Ie,[i(I,{onChange:z,checked:s.value,"onUpdate:checked":m[1]||(m[1]=l=>s.value=l)},null,8,["checked"])]),Ve,e("th",Be,r(t.$t("file_name")),1),c(h)?(d(),f("th",Me,r(t.$t("path")),1)):F("",!0),e("th",Ee,r(t.$t("owner")),1),e("th",Ae,r(t.$t("last_modified")),1),e("th",De,r(t.$t("size")),1)])]),e("tbody",null,[(d(!0),f($,null,D(n.value.data,l=>(d(),f("tr",{key:l.id,onClick:b=>U(l),onDblclick:b=>k(l),class:B(["border-b transition duration-300 ease-in-out hover:bg-blue-100 cursor-pointer",o.value[l.id]||s.value?"bg-blue-50":"bg-white"])},[e("td",Oe,[i(I,{onChange:b=>A(l),modelValue:o.value[l.id],"onUpdate:modelValue":b=>o.value[l.id]=b,checked:o.value[l.id]||s.value},null,8,["onChange","modelValue","onUpdate:modelValue","checked"])]),e("td",je,[e("div",{onClick:J(b=>P(l),["stop","prevent"])},[l.is_favourite?(d(),f("svg",qe,Ke)):(d(),f("svg",Ue,Pe))],8,ze)]),e("td",Re,[i(ee,{file:l},null,8,["file"]),y(" "+r(l.name),1)]),c(h)?(d(),f("td",Te,r(l.path),1)):F("",!0),e("td",Ge,r(l.owner),1),e("td",Je,r(l.updated_at),1),e("td",Qe,r(l.size),1)],42,Le))),128))])]),n.value.data.length?F("",!0):(d(),f("div",We,r(t.$t("folder_is_empty")),1)),e("div",{ref_key:"loadMoreIntersect",ref:u},null,512)])]),_:1}))}};export{dt as default};
